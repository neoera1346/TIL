# S3

- Amazon Simple Storage Service(Amazon S3)는 업계 최고의 확장성, 데이터 가용성 및 보안과 성능을 제공하는 객체 스토리지 서비스다.

- 이 서비스는 개발자가 더 쉽게 웹 규모 컴퓨팅 작업을 수행할 수 있도록 설계되었다.

- 버킷 단위로 지역을 지정할 수 있고, 버킷에 포함된 모든 객체에 대해서 일괄적으로 인증과 접속 제한을 걸 수 있다.

- Amazon S3에 데이터(사진, 동영상, 문서 등)를 업로드하려면 우선 하나의 AWS 리전에 S3 버킷을 만들어야 한다.

- 그런 다음 이 버킷에 객체를 얼마든지 업로드할 수 있다.

- S3의 버킷에는 SPA나 React와 같은 정적인 프로젝트를 올려 사용자가 S3에 접속해 클라이언트에 필요한 자료등을 받아 사용할수 있다.

---

# React Build

- `Create-react-app`을 통해 만든 앱을 **배포하기 알맞은 정적인 형태**로 **난독화**, 즉, 포장하는 것이다.

```
npm build

yarn build
```

- 위 작업 결과로 생기는 Build 폴더 안에 있는 모든 것들을 버킷에 업로그해주면 된다.

---

# Create Bucket

1. 버킷 이름과 리젼(지역) 설정한다.
2. 버킷의 '속성' → '정적 웹 사이트 호스팅' → '이 버킷을 사용하여 웹 사이트를 호스팅합니다' 선택한다.
3. 이후 나타나는 창에서 Entry Point가 되는 인덱스 문서를 올린다. 해당 문서는 웹 사이트에 접속했을 때 보이는 화면이다.
4. 오류 문서도 마찬가지로 올린다. 오류를 핸들링하는 문서가 따로 없다면 Entry Point와 동일하게 설정한다.
5. 저장한다.

**이 엔드포인트에 접속하면 403 Access Denied가 나오는데, 퍼블릭 접속 권한이 없기 때문이다.**

---

# Public Access

1. 버킷의 '권한' → '퍼블릭 액세스 설정' 선택
2. 권장 사항으로 모든 박스가 체크되어 있는데, 모두 풀어준다.
3. 이후 버킷의 '버킷 정책' 선택
4. 버킷 정책 편집기를 JSON 형태로 입력해야한다.
5. 어떻게 입력해야하는지 모른다면 아래의 '정책 생성기'를 클릭한다.
6. Step 1에서 S3 Bucket Policy 선택.
7. Step 2에서 [Principal](https://docs.aws.amazon.com/ko_kr/AmazonS3/latest/dev/s3-bucket-user-policy-specifying-principal-intro.html)을 설정한다. 우선 '\*' 와일드카드를 입력한다.
8. Actions는 'Get Object'를 선택한다.
9. 아래의 형식에 맞춰서 ARN(Amazon Resource Name)을 입력한다. `Key_name`은 별도로 설정할 수 있지만, '\*' 와일드카드로 모든 파일을 선택해줄 수 있다.
10. 생성된 정책을 복사하여 아까의 정책 편집기에 붙여넣는다.

**S3 버킷에 아직 아무것도 넣지 않았기 때문에 해당 엔드포인트로 아직 접속이 불가하다.**

11. Build 폴더의 정적 파일들을 버킷에 업로드한다.
12. 이후 해당 엔드포인트로 접속이 가능하다.
